#!/bin/sh
# Pre-commit hook for client linting and testing

echo "?? Running pre-commit checks..."

# Navigate to client directory
cd client || exit 1

# Run lint with autofix
echo "?? Running ESLint with autofix..."
npm run lint:fix || {
  echo "? ESLint autofix completed, but errors remain. Please fix manually."
  npm run lint
  exit 1
}

# Run lint check to ensure no errors remain
echo "? Running ESLint check..."
npm run lint || {
  echo "? ESLint failed. Please fix the errors above."
  exit 1
}

# Run TypeScript type checking
echo "?? Running TypeScript type check..."
npm run typecheck || {
  echo "? TypeScript type check failed. Please fix the errors above."
  exit 1
}

# Run unit tests
echo "?? Running unit tests..."
npm run test:unit || {
  echo "? Unit tests failed. Please fix the failing tests."
  exit 1
}

echo "? All pre-commit checks passed!"
