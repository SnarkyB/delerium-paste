<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="referrer" content="no-referrer" />
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self'; frame-ancestors 'none'; base-uri 'none'; form-action 'self';">
    <title>Delirium Paste - Secure Zero-Knowledge Paste</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles/design-system.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/pages.css">
    <link rel="stylesheet" href="styles/modals.css">
    <link rel="stylesheet" href="styles/loading.css">
    <link rel="stylesheet" href="styles/mobile.css">
    <link rel="stylesheet" href="styles/highlight-dark.min.css">
  </head>
<body>
    <a href="#main-content" class="sr-only">Skip to main content</a>
    <div class="container">
      <!-- Header -->
      <header class="header" role="banner">
        <h1 class="logo">Delirium Paste</h1>
        <p class="tagline">Secure, Zero-Knowledge Paste Sharing</p>
        <div class="security-badge" role="status" aria-label="Security status">
          <span aria-hidden="true">üîí</span>
          <span>End-to-End Encrypted</span>
        </div>
      </header>

      <!-- Main Card -->
      <main class="card" id="main-content" role="main">
        <!-- Paste Content -->
        <section class="section" aria-labelledby="content-title">
          <h2 class="section-title" id="content-title">Your Content</h2>

          <!-- Write / Preview tabs -->
          <div class="editor-tabs" role="tablist" aria-label="Editor mode">
            <button type="button" class="editor-tab active" id="writeTab"
                    role="tab" aria-selected="true" aria-controls="paste">Write</button>
            <button type="button" class="editor-tab" id="previewTab"
                    role="tab" aria-selected="false" aria-controls="markdownPreview">Preview</button>
          </div>

          <div class="textarea-wrapper">
            <label for="paste" class="sr-only">Paste content</label>
            <textarea
              id="paste"
              name="paste"
              placeholder="Type or paste your text here‚Ä¶ Markdown supported. Content is encrypted in your browser before upload."
              maxlength="1048576"
              aria-describedby="charCounter paste-help"
              aria-required="false"
            ></textarea>
            <div class="char-counter" id="charCounter" role="status" aria-live="polite">0 / 1,048,576</div>
            <div id="paste-help" class="sr-only">Maximum 1,048,576 characters allowed</div>
          </div>

          <!-- Markdown preview pane (hidden until Preview tab active) -->
          <div id="markdownPreview" class="markdown-preview" hidden aria-label="Markdown preview" role="tabpanel"></div>

          <!-- Image upload zone -->
          <div id="imageUploadZone" class="image-upload-zone">
            <input type="file" id="imageFileInput" accept="image/jpeg,image/png,image/webp"
                   multiple aria-label="Upload images" hidden>
            <button type="button" id="imageUploadBtn" class="btn btn-secondary btn-sm">
              Attach Images <span class="text-muted">(max 3 ¬∑ 5 MB each)</span>
            </button>
            <div id="imagePreviews" class="image-previews" role="list" aria-label="Image attachments"></div>
          </div>
        </section>

        <!-- Expiration Options -->
        <section class="section" aria-labelledby="expiration-title">
          <h2 class="section-title" id="expiration-title">Expiration</h2>
          <div class="option-group">
            <label for="mins">
              Expire after (minutes)
              <span class="tooltip" data-tooltip="How long before the paste is automatically deleted" aria-label="Expiration help">‚ÑπÔ∏è</span>
            </label>
            <input
              type="number"
              id="mins"
              name="mins"
              value="60"
              min="1"
              max="10080"
              aria-describedby="expiration-help"
            >
            <div id="expiration-help" class="sr-only">Enter number of minutes before paste expires (1 to 10080)</div>
            <div class="presets" role="group" aria-label="Quick expiration presets">
              <button class="preset-btn" type="button" data-mins="60" aria-label="Set expiration to 1 hour">1 hour</button>
              <button class="preset-btn" type="button" data-mins="1440" aria-label="Set expiration to 1 day">1 day</button>
              <button class="preset-btn" type="button" data-mins="10080" aria-label="Set expiration to 1 week">1 week</button>
            </div>
          </div>
        </section>

        <!-- Security Options -->
        <section class="section" aria-labelledby="security-title">
          <h2 class="section-title" id="security-title">Security Options</h2>

          <div id="passwordGroup">
            <div class="option-group">
              <label for="password">Password or PIN <span aria-label="required">*</span></label>
              <input
                type="password"
                id="password"
                name="password"
                placeholder="Enter a password or 4-12 digit PIN"
                autocomplete="new-password"
                required
                aria-describedby="password-help"
                aria-required="true"
              >
              <div id="password-help" class="sr-only">Required: Enter a password or 4-12 digit PIN to encrypt your paste</div>
            </div>
          </div>
        </section>

        <!-- Submit Button -->
        <button id="save" class="btn-primary" type="button" aria-describedby="save-help">
          <span class="btn-text">
            <span class="btn-icon" aria-hidden="true">üîí</span>
            <span id="btnText">Encrypt &amp; Upload</span>
          </span>
        </button>
        <div id="save-help" class="sr-only">Click to encrypt your content and upload it to the server</div>

        <!-- Output -->
        <div id="output" class="output" role="status" aria-live="polite" aria-atomic="true">
          <div class="output-title" id="outputTitle">Success! Your paste is ready</div>
          <div id="outputMessage"></div>
          <div class="output-url">
            <label for="pasteUrl" style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">Share URL:</label>
            <input type="text" id="pasteUrl" name="pasteUrl" readonly aria-label="Share URL">
            <button class="btn-copy" id="copyBtn" aria-label="Copy share URL">Copy Link</button>
            <button class="btn-view" id="viewBtn" style="display: none;" aria-label="View paste">View Paste</button>
          </div>
          <div class="output-url" id="deleteUrlContainer" style="display: none; margin-top: 0.75rem;">
            <label for="deleteUrl" style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.25rem; display: block;">
              <span aria-hidden="true">üóëÔ∏è</span> Delete URL (save this to delete later):
            </label>
            <input type="text" id="deleteUrl" name="deleteUrl" readonly style="font-size: 0.85rem;" aria-label="Delete URL">
            <button class="btn-copy" id="copyDeleteBtn" aria-label="Copy delete URL">Copy</button>
          </div>
        </div>
      </main>

      <!-- Footer -->
      <footer class="footer" role="contentinfo">
        <p style="margin-top: 0.5rem; font-size: 0.85rem;">
          Your content is encrypted in your browser. We never see your data.
        </p>
      </footer>
    </div>

    <!-- Version Display -->
    <a href="https://github.com/SnarkyB/delerium-paste" target="_blank" rel="noopener noreferrer" class="version-display">v1.0.1-alpha</a>

    <script src="vendor/marked.min.js"></script>
    <script src="vendor/highlight.min.js"></script>
    <script type="module" src="js/app.js"></script>
  </body>
</html>
