# CVE Analysis and Remediation (February 2026)

## Summary

Security analysis of the Delirium Paste codebase and Docker images identified several CVEs. This document records findings, remediations applied, and items requiring ongoing attention.

## Remediated

### 1. Netty (Server – Java Dependencies)

**CVEs addressed:**
| CVE | Severity | Component | Previous | Fixed |
|-----|----------|-----------|----------|-------|
| CVE-2025-58057 | MEDIUM | netty-codec-compression | 4.2.4.Final | 4.2.8.Final |
| CVE-2025-67735 | MEDIUM | netty-codec-http | 4.2.4.Final | 4.2.8.Final |
| CVE-2025-58056 | LOW | netty-codec-http | 4.2.4.Final | 4.2.8.Final |

**Details:**
- **CVE-2025-58057**: BrotliDecoder DoS via zip bomb style payloads
- **CVE-2025-67735**: Request smuggling via CRLF injection
- **CVE-2025-58056**: Request smuggling due to incorrect parsing

**Implementation:** `MODULE.bazel` updated to pin all Netty artifacts at `4.2.8.Final`, including the previously missing `netty-codec-compression` override.

## Not Remediated (Documented)

### 2. Docker Base Image (Ubuntu 22.04 / eclipse-temurin:25-jre-jammy)

**Trivy scan:** 37 vulnerabilities in the runner stage (30 LOW, 7 MEDIUM, 0 HIGH, 0 CRITICAL).

**Notable packages:**
- **curl / libcurl4**: CVE-2025-0167, CVE-2025-14524, CVE-2025-15079, CVE-2025-15224, CVE-2025-9086 (LOW)
- **libexpat1**: CVE-2025-66382 (MEDIUM – DoS via crafted file)
- **gpgv**: CVE-2025-68972 (MEDIUM – signature bypass)
- **libpam-modules**: CVE-2025-8941 (MEDIUM – incomplete fix for CVE-2025-6020)
- **tar**: CVE-2025-45582 (MEDIUM – path traversal)

**Mitigation in place:** `apt-get upgrade -y` in the Dockerfile runner stage upgrades base packages at build time.

**Recommendations:**
- Rebuild images regularly to pick up upstream fixes
- Monitor Eclipse Temurin and Ubuntu security advisories
- Consider `eclipse-temurin:25-jre-noble` (Ubuntu 24.04) when available for fewer legacy CVEs

### 3. npm devDependencies – ajv ReDoS (GHSA-2g4f-4pwh-qvx6)

**Severity:** Moderate  
**Scope:** Dev-only (ESLint chain). Not in production bundle.

**Details:** ajv &lt;8.18.0 has ReDoS when using `$data` option. Affects `@eslint/eslintrc` → `eslint` → `typescript-eslint`.

**Attempted fix:** `npm overrides` for `ajv@>=8.18.0` caused ESLint to fail (`TypeError: Cannot set properties of undefined`). The `@eslint/eslintrc` package expects an older ajv API.

**Recommendations:**
- Accept risk: dev-only, moderate severity, low exploitability (schema validation in CI)
- Track upstream: ESLint flat config and typescript-eslint may drop eslintrc dependency
- `npm audit fix --force` would downgrade ESLint to 4.x (breaking)

## Code Security Notes

### XSS Mitigation

- **Chat messages**: `escapeHtml()` used for all user-controlled content (username, timestamp, message text) before rendering via `innerHTML`. See `client/src/presentation/components/chat-view.ts`.
- **Paste content**: Displayed via `textContent` or escaped before DOM insertion.

### JUnit 4

- **CVE-2020-15250** (TemporaryFolder info disclosure): Project uses JUnit 4.13.2, which includes the fix. No action needed.

## Verification

```bash
# Server build and tests
bazel build //server:delerium_server_deploy --config=ci
bazel test //server:all_tests

# Docker image scan (requires Trivy)
docker build -t delirium-server:test -f server/Dockerfile .
docker run --rm aquasec/trivy image delirium-server:test

# Client
cd client && npm audit && npm run lint && npm test
```

## References

- [Netty 4.2.8.Final](https://netty.io/news/)
- [Trivy](https://trivy.dev/)
- [GHSA-2g4f-4pwh-qvx6](https://github.com/advisories/GHSA-2g4f-4pwh-qvx6) (ajv ReDoS)
